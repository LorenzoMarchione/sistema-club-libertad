# Copilot Instructions for Sistema Club Libertad

- Scope: monorepo with Spring Boot backend in [back/club_libertad](back/club_libertad) and Vite + React + TS frontend in [front/gestion-socios-front](front/gestion-socios-front).
- Run backend from back/club_libertad with `./mvnw spring-boot:run`; Postgres config, logging (SQL enabled), and ddl-auto=update live in [back/club_libertad/src/main/resources/application.properties](back/club_libertad/src/main/resources/application.properties). No security layer.
- CORS only allows http://localhost:3000 in [back/club_libertad/src/main/java/com/club_libertad/config/CorsConfig.java](back/club_libertad/src/main/java/com/club_libertad/config/CorsConfig.java); change to Vite’s 5173 when hitting the backend from dev.
- Controllers are thin and return `ResponseEntity` with 204/404 fallbacks; no global exception handling or validation—sanitize inputs and map null/empty to appropriate HTTP codes.
- Entities are LAZY and use `@JsonIgnore` plus computed *_Ids accessors to avoid cycles. DTOs exist only for incoming payloads; services manually copy fields under `@Transactional` and rely on dirty checking instead of explicit saves (except when associating entities).
- Persona: created from [PersonaDTO](back/club_libertad/src/main/java/com/club_libertad/dtos/PersonaDTO.java) with `fechaRegistro=ZonedDateTime.now()` and `activo=true`; partial updates write only non-null fields; estado toggle flips `activo`; sports association via `/persona/{personaId}/deporte/{deporteId}`; model exposes `socioResponsableId` and `deportesIds` (see [Persona.java](back/club_libertad/src/main/java/com/club_libertad/models/Persona.java)).
- Deporte: default `cuotaMensual=BigDecimal.ZERO`; delete clears persona links before removal to satisfy FK constraints; list personas via `/deporte/{deporteId}/personas` (see [DeporteService.java](back/club_libertad/src/main/java/com/club_libertad/services/DeporteService.java)).
- Cuota: unique on persona+deporte+periodo, `fechaGeneracion=LocalDate.now()`, optional `fechaVencimiento`/`concepto`; PATCH only updates `estado` (see [CuotaService.java](back/club_libertad/src/main/java/com/club_libertad/services/CuotaService.java)).
- Pago: create then loop `cuotaIds` to set `pagoId` and force `EstadoCuota.PAGADA`; no rollback/validation if a cuota is missing (see [PagoService.java](back/club_libertad/src/main/java/com/club_libertad/services/PagoService.java)).
- Inscripcion: create with personaId/deporteId + fechaInscripcion; baja sets `fechaBaja=LocalDate.now()` without deleting (see [InscripcionService.java](back/club_libertad/src/main/java/com/club_libertad/services/InscripcionService.java)).
- Usuario/auth: plain passwords, roles ADMIN|SECRETARIO, and a simple `/usuario/validate` that compares plain text and checks `activo`; no JWT/session (see [UsuarioService.java](back/club_libertad/src/main/java/com/club_libertad/services/UsuarioService.java)).
- Frontend run from front/gestion-socios-front with `npm install && npm run dev`; API base URL is `VITE_API_BASE_URL` (default http://localhost:8080) in [src/services/api.ts](front/gestion-socios-front/src/services/api.ts).
- Data layer: [personaService.ts](front/gestion-socios-front/src/services/personaService.ts) and [deporteService.ts](front/gestion-socios-front/src/services/deporteService.ts) mirror backend paths; personaService currently sends `estado` boolean but backend expects `activo`, and FE fields use `correo` while BE expects `email`—map accordingly when integrating.
- Types: [src/types/persona.ts](front/gestion-socios-front/src/types/persona.ts) uses `id: string`, `estado: 'activo'|'inactivo'`, and `correo`; convert IDs to numbers and rename fields for backend payloads. Deporte type sends `cuotaMensual` as number (backend BigDecimal).
- App flow: [App.tsx](front/gestion-socios-front/src/App.tsx) gates content behind mock login from [components/login-screen.tsx](front/gestion-socios-front/src/components/login-screen.tsx); no real auth call.
- Socios module: [components/socios-module.tsx](front/gestion-socios-front/src/components/socios-module.tsx) loads personas/deportes, has placeholder historial data, forces `deportes` array when missing, and on create/update sends FE-shaped fields—normalize to backend schema before real integration.
- Deportes module: [components/deportes-module.tsx](front/gestion-socios-front/src/components/deportes-module.tsx) creates/edits deportes and associates personas by iterating persona→deporte endpoints; expects persona IDs as strings from FE types.
- Pagos/Promociones/Notificaciones/Admin modules are fully mocked UI/state with toasts and sample data only (no API calls) in [components/pagos-module.tsx](front/gestion-socios-front/src/components/pagos-module.tsx), [components/promociones-module.tsx](front/gestion-socios-front/src/components/promociones-module.tsx), [components/notificaciones-module.tsx](front/gestion-socios-front/src/components/notificaciones-module.tsx), and [components/admin-module.tsx](front/gestion-socios-front/src/components/admin-module.tsx).
- REST conventions: flat paths (no versioning), default server-generated fields (activo true, timestamps, BigDecimal.ZERO), and null-safe PATCH semantics; prefer adding DTOs for inbound payloads.
- Testing: no automated tests; validate endpoints manually (watch LAZY relations—JSON exposes *_Ids helpers instead of full graphs).
